
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="Mathieu Klimczak">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>VoVNet - Documentation Semantic Segmentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vovnet-an-energy-and-gpu-computation-efficient-backbone-network-for-real-time-object-detection" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../../.." title="Documentation Semantic Segmentation" class="md-header__button md-logo" aria-label="Documentation Semantic Segmentation" data-md-component="logo">
      
  <img src="../../../images/logo_blanc.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Documentation Semantic Segmentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              VoVNet
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Basculer en mode sombre"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Basculer en mode sombre" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="deep-orange"  aria-label="Basculer en mode clair"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Basculer en mode clair" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Effacer" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Onglets" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../config_hydra/hydra/" class="md-tabs__link">
      Hydra configuration
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../misc_config/docker/" class="md-tabs__link">
        Various configuration
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../datasets/config/" class="md-tabs__link">
        Datasets creation
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../description/" class="md-tabs__link md-tabs__link--active">
        Semantic segmentation
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../training_loop/train/" class="md-tabs__link">
      Training loop
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../loss/focal_loss/" class="md-tabs__link">
      Loss
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../metrics/mean_iou/" class="md-tabs__link">
      Metrics
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Documentation Semantic Segmentation" class="md-nav__button md-logo" aria-label="Documentation Semantic Segmentation" data-md-component="logo">
      
  <img src="../../../images/logo_blanc.svg" alt="logo">

    </a>
    Documentation Semantic Segmentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../config_hydra/hydra/" class="md-nav__link">
        Hydra configuration
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Various configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Various configuration" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Various configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc_config/docker/" class="md-nav__link">
        Docker config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc_config/make/" class="md-nav__link">
        Makefile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc_config/requirements/" class="md-nav__link">
        Requirements
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Datasets creation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Datasets creation" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Datasets creation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../datasets/config/" class="md-nav__link">
        Dataset configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../datasets/utils_segmentation/" class="md-nav__link">
        Masks creation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../datasets/make_dataset/" class="md-nav__link">
        Train-Test-Val datasets creation
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Datasets pipelines
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Datasets pipelines" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Datasets pipelines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../datasets/classic/" class="md-nav__link">
        Classic pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../datasets/cutmix/" class="md-nav__link">
        CutMix pipeline
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Semantic segmentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Semantic segmentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Semantic segmentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../description/" class="md-nav__link">
        Architecture description
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common_layers/" class="md-nav__link">
        Common layers
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_3">
          Segmentation heads
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Segmentation heads" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Segmentation heads
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../heads/ksac/" class="md-nav__link">
        KSAC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../heads/fpn/" class="md-nav__link">
        FPN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../heads/ocnet/" class="md-nav__link">
        OCNet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../heads/jpu/" class="md-nav__link">
        JPU
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../heads/allmlp/" class="md-nav__link">
        SegFormer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4" type="checkbox" id="__nav_5_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5_4">
          Backbones
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Backbones" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          Backbones
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_1" type="checkbox" id="__nav_5_4_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5_4_1">
          Classic CNNs backbones
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Classic CNNs backbones" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_4_1">
          <span class="md-nav__icon md-icon"></span>
          Classic CNNs backbones
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mobilenetv2/" class="md-nav__link">
        MobileNetv2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ghostnet/" class="md-nav__link">
        GhostNet
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          VoVNet
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        VoVNet
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.model.backbone.vovnet" class="md-nav__link">
    src.model.backbone.vovnet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.model.backbone.vovnet.get_backbone" class="md-nav__link">
    get_backbone()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.model.backbone.vovnet.get_feature_extractor" class="md-nav__link">
    get_feature_extractor()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.model.backbone.vovnet.osa_module" class="md-nav__link">
    osa_module()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#various-configurations-available-as-backbones" class="md-nav__link">
    Various configurations available as backbones
  </a>
  
    <nav class="md-nav" aria-label="Various configurations available as backbones">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vovnet27" class="md-nav__link">
    VoVNet27
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vovnet39" class="md-nav__link">
    VoVNet39
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vovnet57" class="md-nav__link">
    VoVNet57
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../resnet50/" class="md-nav__link">
        ResNet50
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../resnet50v2/" class="md-nav__link">
        ResNet50v2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../resnet101/" class="md-nav__link">
        ResNet101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../resnet101v2/" class="md-nav__link">
        ResNet101v2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2" type="checkbox" id="__nav_5_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_4_2">
          Attention and MLP backbones
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Attention and MLP backbones" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_4_2">
          <span class="md-nav__icon md-icon"></span>
          Attention and MLP backbones
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../convmlp/" class="md-nav__link">
        ConvMLP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mit/" class="md-nav__link">
        MixTransformer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mobilevit/" class="md-nav__link">
        MobileViT
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../training_loop/train/" class="md-nav__link">
        Training loop
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../loss/focal_loss/" class="md-nav__link">
        Loss
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../metrics/mean_iou/" class="md-nav__link">
        Metrics
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.model.backbone.vovnet" class="md-nav__link">
    src.model.backbone.vovnet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.model.backbone.vovnet.get_backbone" class="md-nav__link">
    get_backbone()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.model.backbone.vovnet.get_feature_extractor" class="md-nav__link">
    get_feature_extractor()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.model.backbone.vovnet.osa_module" class="md-nav__link">
    osa_module()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#various-configurations-available-as-backbones" class="md-nav__link">
    Various configurations available as backbones
  </a>
  
    <nav class="md-nav" aria-label="Various configurations available as backbones">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vovnet27" class="md-nav__link">
    VoVNet27
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vovnet39" class="md-nav__link">
    VoVNet39
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vovnet57" class="md-nav__link">
    VoVNet57
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="vovnet-an-energy-and-gpu-computation-efficient-backbone-network-for-real-time-object-detection">VoVNet : An Energy and GPU-Computation Efficient Backbone Network for Real-Time Object Detection</h1>
<div class="admonition note">
<p class="admonition-title">Abstract</p>
<p>As DenseNet conserves intermediate features with diverse receptive fields by aggregating them with dense connection, it shows good performance on the object detection task. Although feature reuse enables DenseNet to produce strong features with a small number of model parameters and FLOPs, the detector with DenseNet backbone shows rather slow speed and low energy efficiency. We find the linearly increasing input channel by dense connection leads to heavy memory access cost, which causes computation overhead and more energy consumption.</p>
<p>To solve the inefficiency of DenseNet, we propose an energy and computation efficient architecture called VoVNet comprised of One-Shot Aggregation (OSA). The OSA not only adopts the strength of DenseNet that represents diversified features with multi receptive fields but also overcomes the inefficiency of dense connection by aggregating all features only once in the last feature maps. To validate the effectiveness of VoVNet as a backbone network, we design both lightweight and large-scale VoVNet and apply them to one-stage and two-stage object detectors.</p>
<p>Our VoVNet based detectors outperform DenseNet based ones with 2x faster speed and the energy consumptions are reduced by 1.6x - 4.1x. In addition to DenseNet, VoVNet also outperforms widely used ResNet backbone with faster speed and better energy efficiency. In particular, the small object detection performance has been significantly improved over DenseNet and ResNet.</p>
<p><a href="https://arxiv.org/abs/1904.09730">ArXiv link</a></p>
</div>


  <div class="doc doc-object doc-module">

<a id="src.model.backbone.vovnet"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h2 id="src.model.backbone.vovnet.get_backbone" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_backbone</span><span class="p">(</span><span class="n">img_shape</span><span class="p">,</span> <span class="n">filters_conv3x3</span><span class="p">,</span> <span class="n">filters_conv1x1</span><span class="p">,</span> <span class="n">block_repetitions</span><span class="p">,</span> <span class="n">backbone_name</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Instantiate the model and use it as a backbone (feature extractor) for a semantic segmentation task.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>img_shape</code></td>
        <td><code>List[int]</code></td>
        <td><p>Input shape of the images/masks in the dataset.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filters_conv3x3</code></td>
        <td><code>List[int]</code></td>
        <td><p>List the number of filters used for the 3x3 <code>Conv2D</code>
in each OSA block.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filters_conv1x1</code></td>
        <td><code>List[int]</code></td>
        <td><p>List the number of filters used for the 1x1 <code>Conv2D</code>
in each OSA block.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>block_repetitions</code></td>
        <td><code>List[int]</code></td>
        <td><p>Determine the number of OSA modules to repeat in each block.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>backbone_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the backbone.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Model</code></td>
      <td><p>A <code>tf.keras</code> model.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>src/model/backbone/vovnet.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_backbone</span><span class="p">(</span>
    <span class="n">img_shape</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">filters_conv3x3</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">filters_conv1x1</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">block_repetitions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">backbone_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Instantiate the model and use it as a backbone (feature extractor) for a semantic segmentation task.</span>

<span class="sd">    Args:</span>
<span class="sd">        img_shape (List[int]): Input shape of the images/masks in the dataset.</span>
<span class="sd">        filters_conv3x3 (List[int]): List the number of filters used for the 3x3 `Conv2D`</span>
<span class="sd">            in each OSA block.</span>
<span class="sd">        filters_conv1x1 (List[int]): List the number of filters used for the 1x1 `Conv2D`</span>
<span class="sd">            in each OSA block.</span>
<span class="sd">        block_repetitions (List[int]): Determine the number of OSA modules to repeat in each block.</span>
<span class="sd">        backbone_name (str): Name of the backbone.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A `tf.keras` model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">backbone</span> <span class="o">=</span> <span class="n">get_feature_extractor</span><span class="p">(</span>
        <span class="n">img_shape</span><span class="o">=</span><span class="n">img_shape</span><span class="p">,</span>
        <span class="n">filters_conv3x3</span><span class="o">=</span><span class="n">filters_conv3x3</span><span class="p">,</span>
        <span class="n">filters_conv1x1</span><span class="o">=</span><span class="n">filters_conv1x1</span><span class="p">,</span>
        <span class="n">block_repetitions</span><span class="o">=</span><span class="n">block_repetitions</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">endpoint_layers</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;maxpool_block1_out&quot;</span><span class="p">,</span>
        <span class="s2">&quot;maxpool_block2_out&quot;</span><span class="p">,</span>
        <span class="s2">&quot;maxpool_block3_out&quot;</span><span class="p">,</span>
        <span class="s2">&quot;maxpool_block4_out&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">os4_output</span><span class="p">,</span> <span class="n">os8_output</span><span class="p">,</span> <span class="n">os16_output</span><span class="p">,</span> <span class="n">os32_output</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">backbone</span><span class="o">.</span><span class="n">get_layer</span><span class="p">(</span><span class="n">layer_name</span><span class="p">)</span><span class="o">.</span><span class="n">output</span> <span class="k">for</span> <span class="n">layer_name</span> <span class="ow">in</span> <span class="n">endpoint_layers</span>
    <span class="p">]</span>

    <span class="n">height</span> <span class="o">=</span> <span class="n">img_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;os4_output OS : </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">height</span><span class="o">/</span><span class="n">os4_output</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">as_list</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;os8_output OS : </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">height</span><span class="o">/</span><span class="n">os8_output</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">as_list</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;os16_output OS : </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">height</span><span class="o">/</span><span class="n">os16_output</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">as_list</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;os32_output OS : </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">height</span><span class="o">/</span><span class="n">os32_output</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">as_list</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Model</span><span class="p">(</span>
        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">backbone</span><span class="o">.</span><span class="n">input</span><span class="p">],</span>
        <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">os4_output</span><span class="p">,</span> <span class="n">os8_output</span><span class="p">,</span> <span class="n">os16_output</span><span class="p">,</span> <span class="n">os32_output</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="n">backbone_name</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="src.model.backbone.vovnet.get_feature_extractor" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_feature_extractor</span><span class="p">(</span><span class="n">img_shape</span><span class="p">,</span> <span class="n">filters_conv3x3</span><span class="p">,</span> <span class="n">filters_conv1x1</span><span class="p">,</span> <span class="n">block_repetitions</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Instantiate a VoVNet model.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>img_shape</code></td>
        <td><code>List[int]</code></td>
        <td><p>Input shape of the images/masks in the dataset.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filters_conv3x3</code></td>
        <td><code>List[int]</code></td>
        <td><p>List the number of filters used for the 3x3 <code>Conv2D</code>
in each OSA block.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filters_conv1x1</code></td>
        <td><code>List[int]</code></td>
        <td><p>List the number of filters used for the 1x1 <code>Conv2D</code>
in each OSA block.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>block_repetitions</code></td>
        <td><code>List[int]</code></td>
        <td><p>Determine the number of OSA modules to repeat in each block.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Model</code></td>
      <td><p>A <code>tf.keras</code> model.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>src/model/backbone/vovnet.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_feature_extractor</span><span class="p">(</span>
    <span class="n">img_shape</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">filters_conv3x3</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">filters_conv1x1</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">block_repetitions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Instantiate a VoVNet model.</span>

<span class="sd">    Args:</span>
<span class="sd">        img_shape (List[int]): Input shape of the images/masks in the dataset.</span>
<span class="sd">        filters_conv3x3 (List[int]): List the number of filters used for the 3x3 `Conv2D`</span>
<span class="sd">            in each OSA block.</span>
<span class="sd">        filters_conv1x1 (List[int]): List the number of filters used for the 1x1 `Conv2D`</span>
<span class="sd">            in each OSA block.</span>
<span class="sd">        block_repetitions (List[int]): Determine the number of OSA modules to repeat in each block.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A `tf.keras` model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># input block</span>
    <span class="n">img_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">img_shape</span><span class="p">)</span>

    <span class="n">fmap</span> <span class="o">=</span> <span class="n">conv_bn_relu</span><span class="p">(</span>
        <span class="n">tensor</span><span class="o">=</span><span class="n">img_input</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stem_stage_1&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">fmap</span> <span class="o">=</span> <span class="n">conv_bn_relu</span><span class="p">(</span>
        <span class="n">tensor</span><span class="o">=</span><span class="n">fmap</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stem_stage_2&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">fmap</span> <span class="o">=</span> <span class="n">conv_bn_relu</span><span class="p">(</span>
        <span class="n">tensor</span><span class="o">=</span><span class="n">fmap</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stem_stage_3&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">idx0</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">block_repetitions</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">fmap</span> <span class="o">=</span> <span class="n">osa_module</span><span class="p">(</span>
            <span class="n">tensor</span><span class="o">=</span><span class="n">fmap</span><span class="p">,</span>
            <span class="n">filters_conv3x3</span><span class="o">=</span><span class="n">filters_conv3x3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">filters_conv1x1</span><span class="o">=</span><span class="n">filters_conv1x1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">block_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;1_</span><span class="si">{</span><span class="n">idx0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">fmap</span> <span class="o">=</span> <span class="n">MaxPool2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;maxpool_block1_out&quot;</span><span class="p">)(</span><span class="n">fmap</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">block_repetitions</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">fmap</span> <span class="o">=</span> <span class="n">osa_module</span><span class="p">(</span>
            <span class="n">tensor</span><span class="o">=</span><span class="n">fmap</span><span class="p">,</span>
            <span class="n">filters_conv3x3</span><span class="o">=</span><span class="n">filters_conv3x3</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">filters_conv1x1</span><span class="o">=</span><span class="n">filters_conv1x1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">block_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;2_</span><span class="si">{</span><span class="n">idx1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">fmap</span> <span class="o">=</span> <span class="n">MaxPool2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;maxpool_block2_out&quot;</span><span class="p">)(</span><span class="n">fmap</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">block_repetitions</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
        <span class="n">fmap</span> <span class="o">=</span> <span class="n">osa_module</span><span class="p">(</span>
            <span class="n">tensor</span><span class="o">=</span><span class="n">fmap</span><span class="p">,</span>
            <span class="n">filters_conv3x3</span><span class="o">=</span><span class="n">filters_conv3x3</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">filters_conv1x1</span><span class="o">=</span><span class="n">filters_conv1x1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">block_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;3_</span><span class="si">{</span><span class="n">idx2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">fmap</span> <span class="o">=</span> <span class="n">MaxPool2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;maxpool_block3_out&quot;</span><span class="p">)(</span><span class="n">fmap</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx3</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">block_repetitions</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
        <span class="n">fmap</span> <span class="o">=</span> <span class="n">osa_module</span><span class="p">(</span>
            <span class="n">tensor</span><span class="o">=</span><span class="n">fmap</span><span class="p">,</span>
            <span class="n">filters_conv3x3</span><span class="o">=</span><span class="n">filters_conv3x3</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">filters_conv1x1</span><span class="o">=</span><span class="n">filters_conv1x1</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">block_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;4_</span><span class="si">{</span><span class="n">idx3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">fmap_out</span> <span class="o">=</span> <span class="n">MaxPool2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;maxpool_block4_out&quot;</span><span class="p">)(</span><span class="n">fmap</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Model</span><span class="p">(</span><span class="n">img_input</span><span class="p">,</span> <span class="n">fmap_out</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;VoVNet&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="src.model.backbone.vovnet.osa_module" class="doc doc-heading">
<code class="highlight language-python"><span class="n">osa_module</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">filters_conv3x3</span><span class="p">,</span> <span class="n">filters_conv1x1</span><span class="p">,</span> <span class="n">block_name</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>One-Shot Aggregation module, the backbone of the VoVNet model.</p>
<div class="admonition architecture">
<p class="admonition-title">Architecture</p>
<p><img alt="Architecture" src="../images/osa_module.svg" /></p>
</div>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>tensor</code></td>
        <td><code>tf.Tensor</code></td>
        <td><p>Input feature map of the module, size = <span class="arithmatex">\((H,W,C)\)</span>.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filters_conv3x3</code></td>
        <td><code>int</code></td>
        <td><p>Numbers of filters used in the 3x3 <code>Conv2D</code> layers.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filters_conv1x1</code></td>
        <td><code>int</code></td>
        <td><p>Numbers of filters used in the 1x1 <code>Conv2D</code> layer.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>block_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the module.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tensor</code></td>
      <td><p>Output feature map, size = <span class="arithmatex">\((H,W,\mathrm{filters\_ conv1x1})\)</span>.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>src/model/backbone/vovnet.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">osa_module</span><span class="p">(</span>
    <span class="n">tensor</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">filters_conv3x3</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">filters_conv1x1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">block_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;One-Shot Aggregation module, the backbone of the VoVNet model.</span>

<span class="sd">    Architecture:</span>
<span class="sd">        ![Architecture](./images/osa_module.svg)</span>

<span class="sd">    Args:</span>
<span class="sd">        tensor (tf.Tensor): Input feature map of the module, size = $(H,W,C)$.</span>
<span class="sd">        filters_conv3x3 (int): Numbers of filters used in the 3x3 `Conv2D` layers.</span>
<span class="sd">        filters_conv1x1 (int): Numbers of filters used in the 1x1 `Conv2D` layer.</span>
<span class="sd">        block_name (str): Name of the module.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Output feature map, size = $(H,W,\mathrm{filters\_ conv1x1})$.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fmap1</span> <span class="o">=</span> <span class="n">conv_bn_relu</span><span class="p">(</span>
        <span class="n">tensor</span><span class="o">=</span><span class="n">tensor</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters_conv3x3</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;conv3_1_block_</span><span class="si">{</span><span class="n">block_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">fmap2</span> <span class="o">=</span> <span class="n">conv_bn_relu</span><span class="p">(</span>
        <span class="n">tensor</span><span class="o">=</span><span class="n">fmap1</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters_conv3x3</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;conv3_2_block_</span><span class="si">{</span><span class="n">block_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">fmap3</span> <span class="o">=</span> <span class="n">conv_bn_relu</span><span class="p">(</span>
        <span class="n">tensor</span><span class="o">=</span><span class="n">fmap2</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters_conv3x3</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;conv3_3_block_</span><span class="si">{</span><span class="n">block_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">fmap4</span> <span class="o">=</span> <span class="n">conv_bn_relu</span><span class="p">(</span>
        <span class="n">tensor</span><span class="o">=</span><span class="n">fmap3</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters_conv3x3</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;conv3_4_block_</span><span class="si">{</span><span class="n">block_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">fmap5</span> <span class="o">=</span> <span class="n">conv_bn_relu</span><span class="p">(</span>
        <span class="n">tensor</span><span class="o">=</span><span class="n">fmap4</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters_conv3x3</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;conv3_5_block_</span><span class="si">{</span><span class="n">block_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">fmap</span> <span class="o">=</span> <span class="n">Concatenate</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;concat_</span><span class="si">{</span><span class="n">block_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)(</span>
        <span class="p">[</span><span class="n">fmap1</span><span class="p">,</span> <span class="n">fmap2</span><span class="p">,</span> <span class="n">fmap3</span><span class="p">,</span> <span class="n">fmap4</span><span class="p">,</span> <span class="n">fmap5</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">conv_bn_relu</span><span class="p">(</span>
        <span class="n">tensor</span><span class="o">=</span><span class="n">fmap</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters_conv1x1</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;conv1_out_block_</span><span class="si">{</span><span class="n">block_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>

<h2 id="various-configurations-available-as-backbones">Various configurations available as backbones</h2>
<h3 id="vovnet27">VoVNet27</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">_target_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">model.backbone.vovnet.get_backbone</span>
<span class="nt">img_shape</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${datasets.params.img_shape}</span>
<span class="nt">filters_conv3x3</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">64</span><span class="p p-Indicator">,</span> <span class="nv">80</span><span class="p p-Indicator">,</span> <span class="nv">96</span><span class="p p-Indicator">,</span> <span class="nv">112</span><span class="p p-Indicator">]</span>
<span class="nt">filters_conv1x1</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">128</span><span class="p p-Indicator">,</span> <span class="nv">256</span><span class="p p-Indicator">,</span> <span class="nv">384</span><span class="p p-Indicator">,</span> <span class="nv">512</span><span class="p p-Indicator">]</span>
<span class="nt">block_repetitions</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">1</span><span class="p p-Indicator">]</span>
<span class="nt">backbone_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">VoVNet27</span>
</code></pre></div>
</td></tr></table>
<h3 id="vovnet39">VoVNet39</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">_target_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">model.backbone.vovnet.get_backbone</span>
<span class="nt">img_shape</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${datasets.params.img_shape}</span>
<span class="nt">filters_conv3x3</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">128</span><span class="p p-Indicator">,</span> <span class="nv">256</span><span class="p p-Indicator">,</span> <span class="nv">192</span><span class="p p-Indicator">,</span> <span class="nv">224</span><span class="p p-Indicator">]</span>
<span class="nt">filters_conv1x1</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">256</span><span class="p p-Indicator">,</span> <span class="nv">512</span><span class="p p-Indicator">,</span> <span class="nv">768</span><span class="p p-Indicator">,</span> <span class="nv">1024</span><span class="p p-Indicator">]</span>
<span class="nt">block_repetitions</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">2</span><span class="p p-Indicator">,</span> <span class="nv">2</span><span class="p p-Indicator">]</span>
<span class="nt">backbone_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">VoVNet39</span>
</code></pre></div>
</td></tr></table>
<h3 id="vovnet57">VoVNet57</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">_target_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">model.backbone.vovnet.get_backbone</span>
<span class="nt">img_shape</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${datasets.params.img_shape}</span>
<span class="nt">filters_conv3x3</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">128</span><span class="p p-Indicator">,</span> <span class="nv">256</span><span class="p p-Indicator">,</span> <span class="nv">192</span><span class="p p-Indicator">,</span> <span class="nv">224</span><span class="p p-Indicator">]</span>
<span class="nt">filters_conv1x1</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">256</span><span class="p p-Indicator">,</span> <span class="nv">512</span><span class="p p-Indicator">,</span> <span class="nv">768</span><span class="p p-Indicator">,</span> <span class="nv">1024</span><span class="p p-Indicator">]</span>
<span class="nt">block_repetitions</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">4</span><span class="p p-Indicator">,</span> <span class="nv">3</span><span class="p p-Indicator">]</span>
<span class="nt">backbone_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">VoVNet57</span>
</code></pre></div>
</td></tr></table>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Retour en haut de la page
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Pied de page">
      
        
        <a href="../ghostnet/" class="md-footer__link md-footer__link--prev" aria-label="Précédent: GhostNet" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Précédent
              </span>
              GhostNet
            </div>
          </div>
        </a>
      
      
        
        <a href="../resnet50/" class="md-footer__link md-footer__link--next" aria-label="Suivant: ResNet50" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Suivant
              </span>
              ResNet50
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.top", "search.highlight", "search.share", "search.suggest"], "translations": {"clipboard.copy": "Copier dans le presse-papier", "clipboard.copied": "Copi\u00e9 dans le presse-papier", "search.config.lang": "fr", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Rechercher", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.term.missing": "Non trouv\u00e9", "select.version.title": "S\u00e9lectionner la version"}, "search": "../../../assets/javascripts/workers/search.8397ff9e.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.1e84347e.min.js"></script>
      
        <script src="../../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>